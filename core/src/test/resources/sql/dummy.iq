# dummy.iq - Scratch space
#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to you under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
!use scott

!if (false) {
# [CALCITE-5360] Correlated NOT IN sub-query with non-equi condition
# Throws: java.lang.NullPointerException
#   at java.base/java.util.Objects.requireNonNull(Objects.java:208)
#   at org.apache.calcite.sql2rel.RelDecorrelator.createValueGenerator(RelDecorrelator.java:833)
SELECT
  (SELECT 1 FROM emp AS d WHERE d.job = a.job LIMIT 1) AS t1,
  (SELECT a.job = 'PRESIDENT' FROM emp AS s LIMIT 1) as t2
FROM emp AS a;
!ok
!}

!if (false) {
with emp1 as (select ename, case when job = 'ANALYST' then 0 else deptno end as deptno from emp)
select ename, deptno,
    (select count(*)
     from emp1 as e2
     where e1.deptno is null) as c
from emp1 as e1;
!plan
!ok
!}

# End dummy.iq
